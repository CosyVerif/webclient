<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>lua.vm.js REPL</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le styles -->
    <link href="lua_vm_js_v2/lua.vm.js/css/bootstrap.css" rel="stylesheet">
    <style>
      body {
        padding-top: 60px; /* 60px to make the container go all the way to the bottom of the topbar */
      }
    </style>
    <link href="lua_vm_js_v2/lua.vm.js/css/bootstrap-responsive.css" rel="stylesheet">

    <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="js/html5shiv.js"></script>
    <![endif]-->

    <!-- codemirror -->
    <script src="lua_vm_js_v2/lua.vm.js/js/codemirror.js"></script>
    <link rel="stylesheet" href="lua_vm_js_v2/lua.vm.js/css/codemirror.css">
    <script src="lua_vm_js_v2/lua.vm.js/js/lua.js"></script>
  </head>

  <body>

    <div class="container">


      <div class="hero-unit">

        <div>
        <h2>Lua REPL</h2>
        <p>This is a <a href="http://en.wikipedia.org/wiki/Read%E2%80%93eval%E2%80%93print_loop">REPL</a> for Lua. Press
           the button to execute the code in the editor below. You can also modify the code and run it again.</p>
      </div>

      <div class="row">
        <div class="span7" border=1>
            <textarea id="mytext">
-- We define our tables
local key = {}
local data = {
    [key] = "something",
    a = { b = 3 },
}
local v1 = data [key]
local v2 = data.a.b

--js.global represent the window object from DOM in javascript
local window = js.global
window.myData = data
window.myKey = key
       
       </textarea>
        </div>
        <div class="span5">
          <h4>output</h4>
          <pre id="output"></pre>
        </div>
      </div>
    
      <p><a href="#" class="btn btn-primary btn-large " onclick="executeLua(myCodeMirror.getValue(), true); return false" id="the_button">Execute &raquo;</a></p>
      
    </div> <!-- /container -->
    
    <script type="text/javascript" languaje="Javascript">
    // CodeMirror
    var myCodeMirror = CodeMirror.fromTextArea(document.getElementById('mytext'));

    // Execution
    var outputElement = document.getElementById('output');
    
    //~ var myData = {};
    //~ var myKey = {};
    
    var Module = {
        print: function(x) {
            outputElement.innerHTML = (outputElement.innerHTML ? outputElement.innerHTML + '<br>' : '') + x;
        }
    };

    function executeLua(code, clear) {
        if (clear) outputElement.innerHTML = '';
        L.execute(code);
        
        //~ v1 = window.myData.get(window.myKey);
        //~ v2 = window.myData.get("a").get("b");
        //~ 
        //~ console.log("Value from V1 " + v1);
        //~ console.log("Value from V2 " + v2);
    }
    </script>
    <script type="text/javascript" languaj="Javascript" src="lua_vm_js_v2/lua.vm.js/lua.vm.js"></script>
</body>
</html>

